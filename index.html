<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Install Exports to Excel</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --brand:#186144;
    --bg:#f8fafc;
    --card:#ffffff;
    --text:#0f172a;
    --muted:#64748b;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;
    background:var(--bg);
    color:var(--text);
    line-height:1.5;
  }
  .wrap{
    max-width:720px;
    margin:40px auto;
    padding:24px;
  }
  .card{
    background:var(--card);
    border-radius:14px;
    box-shadow:0 10px 30px rgba(0,0,0,.08);
    padding:32px;
  }
  h1{
    margin:0 0 8px;
    font-size:1.75rem;
  }
  .sub{
    color:var(--muted);
    margin-bottom:24px;
  }
  .bookmarklet{
    display:inline-block;
    background:var(--brand);
    color:#fff;
    text-decoration:none;
    font-weight:600;
    padding:14px 20px;
    border-radius:10px;
    cursor:grab;
    user-select:none;
  }
  .bookmarklet:active{cursor:grabbing}
  .steps{
    margin-top:28px;
  }
  .step{
    display:flex;
    gap:14px;
    margin-bottom:14px;
  }
  .num{
    width:28px;
    height:28px;
    border-radius:50%;
    background:var(--brand);
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;
    flex-shrink:0;
  }
  .note{
    margin-top:20px;
    padding:14px;
    background:#eef2ff;
    border-radius:10px;
    color:#1e3a8a;
    font-size:.95rem;
  }
  footer{
    margin-top:24px;
    text-align:center;
    color:var(--muted);
    font-size:.85rem;
  }
</style>
</head>
<body>

<div class="wrap">
  <div class="card">
    <h1>Export Controller Data to Excel</h1>
    <p class="sub">One-click tool to export data on a page to an Excel file.</p>

    <p><strong>Drag this button to your bookmarks bar:</strong></p>

    <p>
      <a class="bookmarklet"
href='javascript:(function(){function X(n){var s=(n.innerText||n.textContent||"");s=s.replace(/\u00a0/g," ").replace(/\s+/g," ").trim();return s}function V(e){try{var t=getComputedStyle(e);if(t.display==="none"||t.visibility==="hidden")return!1}catch{}var r=e.getBoundingClientRect();return r.width>0&&r.height>0}function titleText(){return(document.title||"").replace(/\s+/g," ").trim()}function firstProgramH3(){var hs=document.querySelectorAll("h3"),v=[];for(var i=0;i<hs.length;i++)V(hs[i])&&v.push(hs[i]);for(i=0;i<v.length;i++){var t=X(v[i]);if(/^\s*program\b/i.test(t))return t}return v[0]?X(v[0]):""}function dateMDY(s){var d=new Date;return d.getMonth()+1+s+d.getDate()+s+d.getFullYear()}function fname(e){var b=(titleText()||"page")+" "+(firstProgramH3()||"Program")+" "+dateMDY("-");return b.replace(/[/\\:*?"<>|]/g,"-").replace(/\s+/g," ").trim()+"."+e}function getTables(){var t=document.querySelectorAll(".v-data-table table,table"),a=[];for(var i=0;i<t.length;i++)V(t[i])&&a.push(t[i]);return a}function headersOf(t){var h=t.querySelectorAll("thead th,thead td"),a=[];if(h.length){for(var i=0;i<h.length;i++)a.push(X(h[i]));return a}var r=t.querySelector("tr");if(!r)return[];var c=r.querySelectorAll("th,td");for(i=0;i<c.length;i++)a.push(X(c[i]));return a}function hasYes(td){return!!td.querySelector("svg,i.mdi,.v-icon,.mdi,.material-icons")}function parse(t){var h=headersOf(t),trs=t.querySelectorAll(h.length?"tbody tr":"tr"),rows=[],s=0;if(!t.querySelector("thead")&&h.length&&trs.length){var f=[...trs[0].querySelectorAll("th,td")].map(X);f.join("|")==h.join("|")&&(s=1)}var w=-1;for(var i=0;i<h.length;i++)/wait\scompletion/i.test(h[i])&&(w=i);for(i=s;i<trs.length;i++){var tr=trs[i],cs=tr.querySelectorAll("th,td");if(!cs.length)continue;var row=[],y=null;for(var j=0;j<cs.length;j++)j===w?(y=hasYes(cs[j]),row.push(y?"Yes":"No")):row.push(X(cs[j]));rows.push({cells:row,isYes:w>=0?y:null})}return{h,rows,w}}function group(r,w){if(w<0)return null;var g=[],c=[];for(var i=0;i<r.length;i++)r[i].isYes?(g.push(c.concat([r[i]])),c=[]):c.push(r[i]);c.length&&g.push(c.slice());return g}function build(h,g,r){var o=[];if(!g){for(var i=0;i<r.length;i++)o.push([""].concat(r[i].cells));return o}var n=0;for(var k=0;k<g.length;k++){n++;for(i=0;i<g[k].length;i++)o.push([n].concat(g[k][i].cells));var l=g[k][g[k].length-1];l&&l.isYes&&o.push([""].concat(new Array(h.length)))}return o}function load(c,e){if(window.XLSX)return c(XLSX);var s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js";s.onload=function(){c(XLSX)};s.onerror=function(){e(Error("XLSX load failed"))};document.head.appendChild(s)}function sh(n){return(n||"Sheet").replace(/[\/?*:|[\]]/g," ").slice(0,31)||"Sheet"}var tables=getTables();if(!tables.length)return alert("No visible HTML tables found.");load(function(X){var wb=X.utils.book_new();for(var i=0;i<tables.length;i++){var p=parse(tables[i]),g=group(p.rows,p.w),b=build(p.h,g,p.rows),a=[["Step #"].concat(p.h||[])];for(var r=0;r<b.length;r++)a.push(b[r]);X.utils.book_append_sheet(wb,X.utils.aoa_to_sheet(a),sh("Table_"+(i+1)))}X.writeFile(wb,fname("xlsx"))},function(e){alert("Could not export to XLSX: "+e.message)})})();'>
  Export Programs to Excel
</a>

    </p>

        <p>
<a class="bookmarklet"
href='javascript:(function(){function t(e){var n=e.innerText||e.textContent||"";return n=n.replace(/\u00a0/g," ").replace(/\s+/g," ").trim()}function e(t){try{var e=getComputedStyle(t);if("none"===e.display||"hidden"===e.visibility)return!1}catch{}var n=t.getBoundingClientRect();return n.width>0&&n.height>0}function n(){return(document.title||"").replace(/\s+/g," ").trim()}function r(t){var e=new Date;return e.getMonth()+1+t+e.getDate()+t+e.getFullYear()}function o(t){var e=(n()||"page")+" "+r("-");return e.replace(/[:*?"<>|\\/\[\]]/g,"-").replace(/\s+/g," ").trim()+"."+t}function a(t){return(t=(t||"Sheet").replace(/[\/\*\?:\[\]]/g," ").slice(0,31))||"Sheet"}function i(){for(var t=document.querySelectorAll(".v-data-table table,table"),n=[],r=0;r<t.length;r++)e(t[r])&&n.push(t[r]);return n}function s(e){var n=e.querySelectorAll("thead th,thead td"),r=[];if(n.length){for(var o=0;o<n.length;o++)r.push(t(n[o]));return r}var a=e.querySelector("tr");if(!a)return[];var i=a.querySelectorAll("th,td");for(o=0;o<i.length;o++)r.push(t(i[o]));return r}function l(t){for(var e={id:-1,description:-1,io:-1},n=0;n<t.length;n++){var r=t[n].trim().toLowerCase();e.id<0&&/^(id|#)$/.test(r)?e.id=n:e.description<0&&/^(desc|description)$/.test(r)?e.description=n:e.io<0&&/^(io|i\/o)$/.test(r)&&(e.io=n)}var o=[];return["id","description","io"].forEach(function(t){e[t]>=0&&o.push(e[t])}),o}function c(e,n){var r=s(e),o=r.length?e.querySelectorAll("tbody tr"):e.querySelectorAll("tr"),a=[],i=!n||!n.length,l=0;if(!e.querySelector("thead")&&r.length&&o.length){var c=o[0],u=[],d=c.querySelectorAll("th,td");for(var f=0;f<d.length;f++)u.push(t(d[f]));u.join("|")==r.join("|")&&(l=1)}var h=[];if(i)h=r.slice();else for(f=0;f<n.length;f++)h.push(r[n[f]]||"");for(var p=l;p<o.length;p++){var v=o[p];if(v.querySelector("td,th")){var y=v.querySelectorAll("th,td"),m=[];if(i)for(var g=0;g<y.length;g++)m.push(t(y[g]));else for(var b=0;b<n.length;b++){var w=n[b];m.push(y[w]?t(y[w]):"")}a.push(m)}}return{headers:h,rows:a}}function u(t,e){if(window.XLSX)return t(XLSX);var n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js",n.async=!0,n.onload=function(){t(XLSX)},n.onerror=function(){e(Error("Failed to load XLSX library"))},document.head.appendChild(n)}var d=i();if(!d.length)return alert("No visible HTML tables found.");u(function(t){for(var e=t.utils.book_new(),n=0;n<d.length;n++){var r=s(d[n]),i=c(d[n],l(r)),u=[];i.headers.length&&u.push(i.headers);for(var f=0;f<i.rows.length;f++)u.push(i.rows[f]);var h=t.utils.aoa_to_sheet(u);t.utils.book_append_sheet(e,h,a("Table_"+(n+1)))}t.writeFile(e,o("xlsx"))},function(t){alert("Could not export to XLSX: "+t.message)})})();'>
  Export Station List to Excel
</a>

    </p>

    <div class="steps">
      <div class="step">
        <div class="num">1</div>
        <div>Make sure your browserâ€™s <strong>Bookmarks Bar</strong> is visible.</div>
      </div>
      <div class="step">
        <div class="num">2</div>
        <div>Drag the green button you wish to add to the bar.</div>
      </div>
      <div class="step">
        <div class="num">3</div>
        <div>Name the bookmark.</div>
      </div>
      <div class="step">
        <div class="num">4</div>
        <div>Open the steps menu of a program or station list and click the bookmark.</div>
      </div>
    </div>

    <div class="note">
      This tool runs only in your browser. No data is uploaded or shared.
    </div>
  </div>
</div>

</body>
</html>
